<div class="container mt-4">
  <!-- Breadcrumb e Voltar -->
  <div class="row mb-4">
    <div class="col-12">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/products">Produtos</a></li>
          <li class="breadcrumb-item active" aria-current="page">{{product.name}}</li>
        </ol>
      </nav>
    </div>
  </div>

  <div class="row g-4">
    <!-- Coluna da Imagem -->
    <div class="col-lg-5">
      <div class="card shadow-sm border-0 sticky-top" style="top: 20px;">
        <div class="card-body p-4">
          <div class="text-center bg-light rounded p-4">
            <img src="/{{product.image}}" alt="{{product.name}}" class="img-fluid rounded"
              style="max-height: 400px; object-fit: contain;" />
          </div>
          
          <!-- Badge de Status -->
          <div class="mt-3 text-center">
            {{#if (gt product.stock 0)}}
            <span class="badge bg-success fs-6 px-3 py-2">
              <i class="bi bi-check-circle me-1"></i>{{product.stock}} unidades disponíveis
            </span>
            {{else}}
            <span class="badge bg-danger fs-6 px-3 py-2">
              <i class="bi bi-x-circle me-1"></i>Produto Esgotado
            </span>
            {{/if}}
          </div>
        </div>
      </div>
    </div>

    <!-- Coluna de Detalhes -->
    <div class="col-lg-7">
      <div class="card shadow-sm border-0 mb-4">
        <div class="card-body p-4">
          <!-- Título e Ações Admin -->
          <div class="d-flex justify-content-between align-items-start mb-4">
            <h1 class="fw-bold mb-0">{{product.name}}</h1>
            <div class="btn-group" role="group">
              <a href="/products/update/{{product.id}}" class="btn btn-warning">
                <i class="bi bi-pencil me-2"></i>Editar
              </a>
              <button class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#removeModal">
                <i class="bi bi-trash me-2"></i>Remover
              </button>
            </div>
          </div>

          <!-- Preço -->
          <div class="price-section mb-4 p-3 bg-light rounded">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <small class="text-muted d-block">Preço unitário</small>
                <h2 class="text-primary mb-0 fw-bold">R$ {{formatPrice product.price}}</h2>
              </div>
              <div class="text-end">
                <small class="text-muted d-block">Estoque</small>
                <h3 class="mb-0">{{product.stock}}</h3>
              </div>
            </div>
          </div>

          <!-- Descrição -->
          <div class="description-section mb-4">
            <h5 class="fw-semibold mb-3">
              <i class="bi bi-info-circle me-2"></i>Descrição
            </h5>
            <p class="text-muted">{{product.description}}</p>
          </div>

          {{#if product.category}}
          <div class="category-section mb-4">
            <h6 class="fw-semibold mb-2">
              <i class="bi bi-tag me-2"></i>Categoria
            </h6>
            <span class="badge bg-secondary fs-6 px-3 py-2">{{product.category}}</span>
          </div>
          {{/if}}

          <hr>

          <!-- Adicionar ao Carrinho -->
          <div class="action-section">
            <h5 class="fw-semibold mb-3">
              <i class="bi bi-cart-plus me-2"></i>Adicionar ao Carrinho
            </h5>
            <form action="/purchaseItem/add" method="post" enctype="multipart/form-data">
              <input type="hidden" name="productId" value="{{product.id}}" />
              <div class="row g-3">
                <div class="col-md-4">
                  <label for="quantity" class="form-label">Quantidade</label>
                  <select name="quantity" id="quantity" class="form-select form-select-lg">
                    {{#each quantityArray}}
                    <option value="{{this}}">{{this}}</option>
                    {{/each}}
                  </select>
                </div>
                <div class="col-md-8 d-flex align-items-end">
                  <button type="submit" class="btn btn-primary btn-lg w-100">
                    <i class="bi bi-cart-plus me-2"></i>Adicionar ao Carrinho
                  </button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Card de Informações Adicionais -->
      <div class="card shadow-sm border-0">
        <div class="card-body p-4">
          <h5 class="fw-semibold mb-3">
            <i class="bi bi-shield-check me-2"></i>Informações de Compra
          </h5>
          <div class="row g-3">
            <div class="col-md-6">
              <div class="d-flex align-items-center">
                <i class="bi bi-truck fs-4 text-success me-3"></i>
                <div>
                  <h6 class="mb-0">Frete Grátis</h6>
                  <small class="text-muted">Para todo o Brasil</small>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center">
                <i class="bi bi-credit-card fs-4 text-primary me-3"></i>
                <div>
                  <h6 class="mb-0">Pagamento Seguro</h6>
                  <small class="text-muted">Compra 100% protegida</small>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center">
                <i class="bi bi-arrow-clockwise fs-4 text-info me-3"></i>
                <div>
                  <h6 class="mb-0">7 dias para trocas</h6>
                  <small class="text-muted">Troca facilitada</small>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="d-flex align-items-center">
                <i class="bi bi-headset fs-4 text-warning me-3"></i>
                <div>
                  <h6 class="mb-0">Suporte 24/7</h6>
                  <small class="text-muted">Atendimento dedicado</small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Remoção -->
<div class="modal fade" id="removeModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
  aria-labelledby="removeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title" id="removeModalLabel">
          <i class="bi bi-exclamation-triangle me-2"></i>Confirmar Exclusão
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p class="mb-0">Deseja realmente remover o produto <strong>{{product.name}}</strong>?</p>
        <p class="text-muted small mt-2 mb-0">Esta ação não poderá ser desfeita.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
          <i class="bi bi-x-circle me-2"></i>Cancelar
        </button>
        <button onclick="removeProduct('{{product.id}}')" type="button" class="btn btn-danger">
          <i class="bi bi-trash me-2"></i>Sim, Remover
        </button>
      </div>
    </div>
  </div>
</div>